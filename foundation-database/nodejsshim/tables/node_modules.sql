SELECT xt.create_table('node_modules', 'nodejsshim');

SELECT xt.add_column('node_modules', 'node_modules_id', 'serial', 'PRIMARY KEY', 'nodejsshim', 'Database id column for node_modules table.');
SELECT xt.add_column('node_modules', 'node_modules_package_name', 'text', 'NOT NULL', 'nodejsshim', 'The package name of the library.');
SELECT xt.add_column('node_modules', 'node_modules_path', 'text', '', 'nodejsshim', 'The relative path of the package.');
SELECT xt.add_column('node_modules', 'node_modules_version', 'text', 'NOT NULL', 'nodejsshim', 'The version of the library.');
SELECT xt.add_column('node_modules', 'node_modules_url', 'text', 'NOT NULL', 'nodejsshim', 'The URL of the library.');
SELECT xt.add_column('node_modules', 'node_modules_code', 'text', 'NOT NULL', 'nodejsshim', 'The library javascript code.');
SELECT xt.add_column('node_modules', 'node_modules_created', 'timestamp with time zone', 'NOT NULL DEFAULT NOW()', 'nodejsshim', 'The date this record was created.');
SELECT xt.add_column('node_modules', 'node_modules_lastupdated', 'timestamp with time zone', 'NOT NULL DEFAULT NOW()', 'nodejsshim', 'The date this record was last updated.');
SELECT xt.add_column('node_modules', 'node_modules_lastusername', 'text', 'NOT NULL DEFAULT CURRENT_USER', 'nodejsshim', 'The username of the user that last updated this record.');
SELECT xt.add_column('node_modules', 'obj_uuid', 'uuid', 'DEFAULT uuid_generate_v4()', 'nodejsshim', 'A UUID for this record.');

COMMENT ON TABLE nodejsshim.node_modules IS 'Stores Javascript libraries.';

SELECT xt.add_constraint('node_modules','node_modules_unique_node_modules_package_name', 'unique(node_modules_package_name)', 'nodejsshim');

GRANT ALL ON TABLE nodejsshim.node_modules TO xtrole;
GRANT ALL ON SEQUENCE nodejsshim.node_modules_node_modules_id_seq TO xtrole;
